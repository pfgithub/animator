const t=Symbol("solid-proxy"),e={equals:(t,e)=>t===e};let n=null,r=R;const i={},o={owned:null,cleanups:null,context:null,owner:null};var s=null;let l=null,u=null,f=null,h=null,a=0;function c(t,e){e&&(s=e);const n=l,r=s,i=0===t.length?o:{owned:null,cleanups:null,context:null,owner:r};let u;s=i,l=null;try{P((()=>u=t((()=>M(i)))),!0)}finally{l=n,s=r}return u}function p(t,n){n=n?Object.assign({},e,n):e;const r={value:t,observers:null,observerSlots:null,pending:i,comparator:n.equals||void 0};return[E.bind(r),t=>("function"==typeof t&&(t=t(r.pending!==i?r.pending:r.value)),S(r,t))]}function g(t,e,n){_(w(t,e,!1,1))}function y(t,e,n){r=A;const i=w(t,e,!1,1);i.user=!0,h&&h.push(i)}function v(t,n,r){r=r?Object.assign({},e,r):e;const o=w(t,n,!0,0);return o.pending=i,o.observers=null,o.observerSlots=null,o.comparator=r.equals||void 0,_(o),E.bind(o)}function d(t){if(u)return t();let e;const n=u=[];try{e=t()}finally{u=null}return P((()=>{for(let t=0;t<n.length;t+=1){const e=n[t];if(e.pending!==i){const t=e.pending;e.pending=i,S(e,t)}}}),!1),e}function x(t){let e,n=l;return l=null,e=t(),l=n,e}function b(t){return null===s||(null===s.cleanups?s.cleanups=[t]:s.cleanups.push(t)),t}function m(){return l}function E(){if(this.state&&this.sources){const t=f;f=null,1===this.state?_(this):I(this),f=t}if(l){const t=this.observers?this.observers.length:0;l.sources?(l.sources.push(this),l.sourceSlots.push(t)):(l.sources=[this],l.sourceSlots=[t]),this.observers?(this.observers.push(l),this.observerSlots.push(l.sources.length-1)):(this.observers=[l],this.observerSlots=[l.sources.length-1])}return this.value}function S(t,e,n){if(t.comparator&&t.comparator(t.value,e))return e;if(u)return t.pending===i&&u.push(t),t.pending=e,e;let r=!1;return t.value=e,t.observers&&t.observers.length&&P((()=>{for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];r,n.pure?f.push(n):h.push(n),n.observers&&!n.state&&O(n),n.state=1}if(f.length>1e6)throw f=[],new Error}),!1),e}function _(t){if(!t.fn)return;M(t);const e=s,n=l,r=a;l=s=t,function(t,e,n){let r;try{r=t.fn(e)}catch(i){N(i)}(!t.updatedAt||t.updatedAt<=n)&&(t.observers&&t.observers.length?S(t,r):t.value=r,t.updatedAt=n)}(t,t.value,r),l=n,s=e}function w(t,e,n,r=1,i){const l={fn:t,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:s,context:null,pure:n};return null===s||s!==o&&(s.owned?s.owned.push(l):s.owned=[l]),l}function k(t){if(1!==t.state)return t.state=0;if(t.suspense&&x(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<a);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(1===(t=e[n]).state)_(t);else if(2===t.state){const e=f;f=null,I(t),f=e}}function P(t,e){if(f)return t();let n=!1;e||(f=[]),h?n=!0:h=[],a++;try{t()}catch(i){N(i)}finally{!function(t){f&&(R(f),f=null);if(t)return;h.length?d((()=>{r(h),h=null})):h=null}(n)}}function R(t){for(let e=0;e<t.length;e++)k(t[e])}function A(t){let e,n=0;for(e=0;e<t.length;e++){const r=t[e];r.user?t[n++]=r:k(r)}const r=t.length;for(e=0;e<n;e++)k(t[e]);for(e=r;e<t.length;e++)k(t[e])}function I(t){t.state=0;for(let e=0;e<t.sources.length;e+=1){const n=t.sources[e];n.sources&&(1===n.state?k(n):2===n.state&&I(n))}}function O(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=2,n.pure?f.push(n):h.push(n),n.observers&&O(n))}}function M(t){let e;if(t.sources)for(;t.sources.length;){const e=t.sources.pop(),n=t.sourceSlots.pop(),r=e.observers;if(r&&r.length){const t=r.pop(),i=e.observerSlots.pop();n<r.length&&(t.sourceSlots[i]=n,r[n]=t,e.observerSlots[n]=i)}}if(t.owned){for(e=0;e<t.owned.length;e++)M(t.owned[e]);t.owned=null}if(t.cleanups){for(e=0;e<t.cleanups.length;e++)t.cleanups[e]();t.cleanups=null}t.state=0,t.context=null}function N(t){const e=n&&L(s,n);if(!e)throw t;e.forEach((e=>e(t)))}function L(t,e){return t&&(t.context&&t.context[e]||t.owner&&L(t.owner,e))}const j=Symbol("fallback");function C(t){for(let e=0;e<t.length;e++)t[e]()}function z(t,e){return x((()=>t(e)))}function B(t){const e="fallback"in t&&{fallback:()=>t.fallback};return v(function(t,e,n={}){let r=[],i=[],o=[],s=0,l=e.length>1?[]:null;return b((()=>C(o))),()=>{let u,f,h=t()||[];return x((()=>{let t,e,p,g,y,v,d,x,b,m=h.length;if(0===m)0!==s&&(C(o),o=[],r=[],i=[],s=0,l&&(l=[])),n.fallback&&(r=[j],i[0]=c((t=>(o[0]=t,n.fallback()))),s=1);else if(0===s){for(i=new Array(m),f=0;f<m;f++)r[f]=h[f],i[f]=c(a);s=m}else{for(p=new Array(m),g=new Array(m),l&&(y=new Array(m)),v=0,d=Math.min(s,m);v<d&&r[v]===h[v];v++);for(d=s-1,x=m-1;d>=v&&x>=v&&r[d]===h[x];d--,x--)p[x]=i[d],g[x]=o[d],l&&(y[x]=l[d]);for(t=new Map,e=new Array(x+1),f=x;f>=v;f--)b=h[f],u=t.get(b),e[f]=void 0===u?-1:u,t.set(b,f);for(u=v;u<=d;u++)b=r[u],f=t.get(b),void 0!==f&&-1!==f?(p[f]=i[u],g[f]=o[u],l&&(y[f]=l[u]),f=e[f],t.set(b,f)):o[u]();for(f=v;f<m;f++)f in p?(i[f]=p[f],o[f]=g[f],l&&(l[f]=y[f],l[f](f))):i[f]=c(a);i=i.slice(0,s=m),r=h.slice(0)}return i}));function a(t){if(o[f]=t,l){const[t,n]=p(f);return l[f]=n,e(h[f],t)}return e(h[f])}}}((()=>t.each),t.children,e||void 0))}function T(t){const[e,r]=p();let i;return v((()=>{if(null!=(i=e())){const e=t.fallback;return"function"==typeof e&&e.length?x((()=>e(i,(()=>r(null))))):e}var o;return o=r,n||(n=Symbol("error")),null===s||(null===s.context?s.context={[n]:[o]}:s.context[n]?s.context[n].push(o):s.context[n]=[o]),t.children}))}function D(t,e,n){let r=n.length,i=e.length,o=r,s=0,l=0,u=e[i-1].nextSibling,f=null;for(;s<i||l<o;)if(e[s]!==n[l]){for(;e[i-1]===n[o-1];)i--,o--;if(i===s){const e=o<r?l?n[l-1].nextSibling:n[o-l]:u;for(;l<o;)t.insertBefore(n[l++],e)}else if(o===l)for(;s<i;)f&&f.has(e[s])||t.removeChild(e[s]),s++;else if(e[s]===n[o-1]&&n[l]===e[i-1]){const r=e[--i].nextSibling;t.insertBefore(n[l++],e[s++].nextSibling),t.insertBefore(n[--o],r),e[i]=n[o]}else{if(!f){f=new Map;let t=l;for(;t<o;)f.set(n[t],t++)}const r=f.get(e[s]);if(null!=r)if(l<r&&r<o){let u,h=s,a=1;for(;++h<i&&h<o&&null!=(u=f.get(e[h]))&&u===r+a;)a++;if(a>r-l){const i=e[s];for(;l<r;)t.insertBefore(n[l++],i)}else t.replaceChild(n[l++],e[s++])}else s++;else t.removeChild(e[s++])}}else s++,l++}function F(t,e,n){let r;return c((i=>{r=i,V(e,t(),e.firstChild?null:void 0,n)})),()=>{r(),e.textContent=""}}function G(t,e,n){const r=document.createElement("template");r.innerHTML=t;let i=r.content.firstChild;return n&&(i=i.firstChild),i}function q(t,e=window.document){const n=e._$DX_DELEGATE||(e._$DX_DELEGATE=new Set);for(let r=0,i=t.length;r<i;r++){const i=t[r];n.has(i)||(n.add(i),e.addEventListener(i,H))}}function $(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function V(t,e,n,r){if(void 0===n||r||(r=[]),"function"!=typeof e)return U(t,e,r,n);g((r=>U(t,e(),r,n)),r)}function H(t){const e=`$$${t.type}`;let n=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==n&&Object.defineProperty(t,"target",{configurable:!0,value:n}),Object.defineProperty(t,"currentTarget",{configurable:!0,get:()=>n});null!==n;){const r=n[e];if(r&&!n.disabled){const i=n[`${e}Data`];if(void 0!==i?r(i,t):r(t),t.cancelBubble)return}n=n.host&&n.host!==n&&n.host instanceof Node?n.host:n.parentNode}}function U(t,e,n,r,i){for(;"function"==typeof n;)n=n();if(e===n)return n;const o=typeof e,s=void 0!==r;if(t=s&&n[0]&&n[0].parentNode||t,"string"===o||"number"===o)if("number"===o&&(e=e.toString()),s){let i=n[0];i&&3===i.nodeType?i.data=e:i=document.createTextNode(e),n=J(t,n,r,i)}else n=""!==n&&"string"==typeof n?t.firstChild.data=e:t.textContent=e;else if(null==e||"boolean"===o)n=J(t,n,r);else{if("function"===o)return g((()=>{let i=e();for(;"function"==typeof i;)i=i();n=U(t,i,n,r)})),()=>n;if(Array.isArray(e)){const o=[];if(Y(o,e,i))return g((()=>n=U(t,o,n,r,!0))),()=>n;if(0===o.length){if(n=J(t,n,r),s)return n}else Array.isArray(n)?0===n.length?X(t,o,r):D(t,n,o):null==n||""===n?X(t,o):D(t,s&&n||[t.firstChild],o);n=o}else if(e instanceof Node){if(Array.isArray(n)){if(s)return n=J(t,n,r,e);J(t,n,null,e)}else null!=n&&""!==n&&t.firstChild?t.replaceChild(e,t.firstChild):t.appendChild(e);n=e}}return n}function Y(t,e,n){let r=!1;for(let i=0,o=e.length;i<o;i++){let o,s=e[i];if(s instanceof Node)t.push(s);else if(null==s||!0===s||!1===s);else if(Array.isArray(s))r=Y(t,s)||r;else if("string"==(o=typeof s))t.push(document.createTextNode(s));else if("function"===o)if(n){for(;"function"==typeof s;)s=s();r=Y(t,Array.isArray(s)?s:[s])||r}else t.push(s),r=!0;else t.push(document.createTextNode(s.toString()))}return r}function X(t,e,n){for(let r=0,i=e.length;r<i;r++)t.insertBefore(e[r],n)}function J(t,e,n,r){if(void 0===n)return t.textContent="";const i=r||document.createTextNode("");if(e.length){let r=!1;for(let o=e.length-1;o>=0;o--){const s=e[o];if(i!==s){const e=s.parentNode===t;r||o?e&&t.removeChild(s):e?t.replaceChild(i,s):t.insertBefore(i,n)}else r=!0}}else t.insertBefore(i,n);return[i]}const K=Symbol("store-raw"),Q=Symbol("store-node"),W=Symbol("store-name");function Z(e,n){let r=e[t];if(!r){Object.defineProperty(e,t,{value:r=new Proxy(e,it)});const n=Object.keys(e),i=Object.getOwnPropertyDescriptors(e);for(let t=0,o=n.length;t<o;t++){const o=n[t];if(i[o].get){const t=i[o].get.bind(r);Object.defineProperty(e,o,{get:t})}}}return r}function tt(t){return null!=t&&"object"==typeof t&&(!t.__proto__||t.__proto__===Object.prototype||Array.isArray(t))}function et(t,e=new Set){let n,r,i,o;if(n=null!=t&&t[K])return n;if(!tt(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let n=0,o=t.length;n<o;n++)i=t[n],(r=et(i,e))!==i&&(t[n]=r)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const n=Object.keys(t),s=Object.getOwnPropertyDescriptors(t);for(let l=0,u=n.length;l<u;l++)o=n[l],s[o].get||(i=t[o],(r=et(i,e))!==i&&(t[o]=r))}return t}function nt(t){let e=t[Q];return e||Object.defineProperty(t,Q,{value:e={}}),e}function rt(){const[t,e]=p(void 0,{equals:!1,internal:!0});return t.$=e,t}const it={get(e,n,r){if(n===K)return e;if(n===t)return r;const i=e[n];if(n===Q||"__proto__"===n)return i;const o=tt(i);if(m()&&("function"!=typeof i||e.hasOwnProperty(n))){let t,r;o&&(t=nt(i))&&(r=t._||(t._=rt()),r()),t=nt(e),r=t[n]||(t[n]=rt()),r()}return o?Z(i):i},set:()=>!0,deleteProperty:()=>!0,ownKeys:function(t){if(m()){const e=nt(t);(e._||(e._=rt()))()}return Reflect.ownKeys(t)},getOwnPropertyDescriptor:function(e,n){const r=Reflect.getOwnPropertyDescriptor(e,n);return!r||r.get||n===t||n===Q||n===W||(delete r.value,delete r.writable,r.get=()=>e[t][n]),r}};function ot(t,e,n){if(t[e]===n)return;const r=Array.isArray(t),i=t.length,o=void 0===n,s=r||o===e in t;o?delete t[e]:t[e]=n;let l,u=nt(t);(l=u[e])&&l.$(),r&&t.length!==i&&(l=u.length)&&l.$(l,void 0),s&&(l=u._)&&l.$(l,void 0)}function st(t,e,n=[]){let r,i=t;if(e.length>1){r=e.shift();const o=typeof r,s=Array.isArray(t);if(Array.isArray(r)){for(let i=0;i<r.length;i++)st(t,[r[i]].concat(e),[r[i]].concat(n));return}if(s&&"function"===o){for(let i=0;i<t.length;i++)r(t[i],i)&&st(t,[i].concat(e),[i].concat(n));return}if(s&&"object"===o){const{from:i=0,to:o=t.length-1,by:s=1}=r;for(let r=i;r<=o;r+=s)st(t,[r].concat(e),[r].concat(n));return}if(e.length>1)return void st(t[r],e,[r].concat(n));i=t[r],n=[r].concat(n)}let o=e[0];"function"==typeof o&&(o=o(i,n),o===i)||void 0===r&&null==o||(o=et(o),void 0===r||tt(i)&&tt(o)&&!Array.isArray(o)?function(t,e){const n=Object.keys(e);for(let r=0;r<n.length;r+=1){const i=n[r];ot(t,i,e[i])}}(i,o):ot(t,r,o))}function lt(t,e){const n=et(t||{});return[Z(n),function(...t){d((()=>st(n,t)))}]}function ut(t,e,n,r,i){const o=e[n];if(t===o)return;if(!tt(t)||!tt(o)||i&&t[i]!==o[i])return void(t!==o&&ot(e,n,t));if(Array.isArray(t)){if(t.length&&o.length&&(!r||i&&null!=t[0][i])){let e,n,s,l,u,f,h,a;for(s=0,l=Math.min(o.length,t.length);s<l&&(o[s]===t[s]||i&&o[s][i]===t[s][i]);s++)ut(t[s],o,s,r,i);const c=new Array(t.length),p=new Map;for(l=o.length-1,u=t.length-1;l>=s&&u>=s&&(o[l]===t[u]||i&&o[l][i]===t[u][i]);l--,u--)c[u]=o[l];if(s>u||s>l){for(n=s;n<=u;n++)ot(o,n,t[n]);for(;n<t.length;n++)ot(o,n,c[n]),ut(t[n],o,n,r,i);return void(o.length>t.length&&ot(o,"length",t.length))}for(h=new Array(u+1),n=u;n>=s;n--)f=t[n],a=i?f[i]:f,e=p.get(a),h[n]=void 0===e?-1:e,p.set(a,n);for(e=s;e<=l;e++)f=o[e],a=i?f[i]:f,n=p.get(a),void 0!==n&&-1!==n&&(c[n]=o[e],n=h[n],p.set(a,n));for(n=s;n<t.length;n++)n in c?(ot(o,n,c[n]),ut(t[n],o,n,r,i)):ot(o,n,t[n])}else for(let e=0,n=t.length;e<n;e++)ut(t[e],o,e,r,i);return void(o.length>t.length&&ot(o,"length",t.length))}const s=Object.keys(t);for(let u=0,f=s.length;u<f;u++)ut(t[s[u]],o,s[u],r,i);const l=Object.keys(o);for(let u=0,f=l.length;u<f;u++)void 0===t[l[u]]&&ot(o,l[u],void 0)}function ft(t,e={}){const{merge:n,key:r="id"}=e,i=et(t);return t=>{const e=t;return tt(e)&&tt(i)?(ut(i,{state:e},"state",n,r),e):i}}function ht(t,e){return[t[0]+e[0],t[1]+e[1]]}function at(t,e){return[t[0]-e[0],t[1]-e[1]]}function ct(t,e){return[e[0]-t[0],e[1]-t[1]]}function pt(t,e){return[t[0]*e,t[1]*e]}function gt(t){return[t[1],-t[0]]}function yt(t,e){return t[0]*e[0]+t[1]*e[1]}function vt(t,e){return function(t){return t[0]*t[0]+t[1]*t[1]}(at(t,e))}function dt(t){return function(t,e){return[t[0]/e,t[1]/e]}(t,function(t){return Math.hypot(t[0],t[1])}(t))}function xt(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function bt(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=t[0]-e[0],s=t[1]-e[1],l=o*r+s*i;return[o*i-s*r+e[0],l+e[1]]}function mt(t,e,n){return ht(t,pt(ct(t,e),n))}function Et(t,e){return t[0]===e[0]&&t[1]===e[1]}function St(t,e,n){return t*(1-n)+e*n}function _t(t,e,n){return Math.max(e,Math.min(n,t))}function wt(t,e,n,r=.5){return e?(r=_t(n(r),0,1),(e<0?St(t,t+t*_t(e,-.95,-.05),r):St(t-t*_t(e,.05,.95),t,r))/2):t/2}var{min:kt,PI:Pt}=Math;function Rt(t,e={}){let{streamline:n=.5}=e,{simulatePressure:r=!0}=e;n/=r?4:2;let i=function(t){return Array.isArray(t[0])?t.map((([t,e,n=.5])=>[t,e,n])):t.map((({x:t,y:e,pressure:n=.5})=>[t,e,n]))}(t);if(0===i.length)return[];1===i.length&&i.push([...ht(i[0],[1,1]),i[0][2]]);let o=[{point:[i[0][0],i[0][1]],pressure:i[0][2],vector:[0,0],distance:0,runningLength:0}];for(let s=1,l=0,u=i[s],f=o[l];s<i.length;s++,u=i[s],f=o[l]){let t=mt(f.point,u,1-n);if(Et(f.point,t))continue;let e=dt(at(f.point,t)),r=xt(t,f.point),i=f.runningLength+r,s={point:t,pressure:u[2],vector:e,distance:r,runningLength:i};o.push(s),l+=1}return o}function At(t,e={}){let{size:n=8,thinning:r=.5,smoothing:i=.5,simulatePressure:o=!0,easing:s=(t=>t),start:l={},end:u={},last:f=!1}=e,{streamline:h=.5}=e;h/=2;let{cap:a=!0,taper:c=0,easing:p=(t=>t*(2-t))}=l,{cap:g=!0,taper:y=0,easing:v=(t=>--t*t*t+1)}=u,d=t.length;if(0===d)return[];let x=t[d-1].runningLength,b=[],m=[],E=t.slice(0,5).reduce(((t,e)=>(t+e.pressure)/2),t[0].pressure),S=wt(n,r,s,t[d-1].pressure),_=t[0].vector,w=t[0].point,k=w,P=w,R=k,A=!0;for(let j=0;j<d-1;j++){let{pressure:e}=t[j],{point:l,vector:u,distance:f,runningLength:a}=t[j];if(j>0&&A&&a<n/2)continue;if(A&&(A=!1),r){if(o){let t=kt(1,1-f/n),r=kt(1,f/n);e=kt(1,E+r/2*(t-E))}S=wt(n,r,s,e)}else S=n/2;let g=a<c?p(a/c):1,d=x-a<y?v((x-a)/y):1;S=Math.max(.01,S*Math.min(g,d));let I=t[j+1].vector,O=yt(u,I);if(O<0){let t=pt(gt(_),S);for(let e=0;e<1;e+=.2)R=bt(ht(l,t),l,Pt*-e),P=bt(at(l,t),l,Pt*e),m.push(R),b.push(P);w=P,k=R;continue}let M=pt(gt(mt(I,u,O)),S);P=at(l,M),R=ht(l,M);let N=j<2||O<.25,L=Math.pow(Math.max((a>n?n:n/2)*i,1),2);(N||vt(w,P)>L)&&(b.push(mt(w,P,h)),w=P),(N||vt(k,R)>L)&&(m.push(mt(k,R,h)),k=R),E=e,_=u}let I=t[0],O=t[d-1],M=A||m.length<2||b.length<2;if(M&&(!c&&!y||f)){let e=0;for(let l=0;l<d;l++){let{pressure:i,runningLength:o}=t[l];if(o>n){e=wt(n,r,s,i);break}}let i=at(I.point,pt(gt(dt(ct(O.point,I.point))),e||S)),o=[];for(let t=0,n=.1;t<=1;t+=n)o.push(bt(i,I.point,2*Pt*t));return o}let N=[],L=[];if(b.length>1&&m.length>1){R=m[1];for(let e=1;e<b.length;e++)if(!Et(R,b[e])){P=b[e];break}if(a||c){if(c||y&&M)N.push(I.point,ht(I.point,[.1,.1]));else if(!Et(R,P)){let t=at(I.point,pt(dt(ct(R,P)),xt(R,P)/2));for(let e=0,n=.1;e<=1;e+=n)N.push(bt(t,I.point,Pt*e));b.shift(),m.shift()}}else if(!Et(R,P)){let t=dt(ct(R,P)),e=xt(R,P)/2;N.push(at(I.point,pt(t,.95*e))),N.push(at(I.point,pt(t,e))),N.push(ht(I.point,pt(t,e))),N.push(ht(I.point,pt(t,.95*e))),b.shift(),m.shift()}let t=function(t,e){return pt(ht(t,e),.5)}(b[b.length-1],m[m.length-1]),n=e.last?O.point:mt(t,O.point,.618),r=dt(at(n,t));if(g||y)if(y||c&&M)L.push(n);else{let t=ht(n,pt(gt(r),S));for(let e=0,r=.15;e<=1;e+=r)L.push(bt(t,n,3*Pt*e))}else{let e=mt(t,n,.95),i=.95*S;L.push(ht(e,pt(gt(r),i))),L.push(ht(n,pt(gt(r),i))),L.push(at(n,pt(gt(r),i))),L.push(at(e,pt(gt(r),i)))}}return b.concat(L,m.reverse(),N)}function It(t,e={}){return At(Rt(t,e),e)}
/**
 * splaytree v3.1.0
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */var Ot=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function Mt(t,e){return t>e?1:t<e?-1:0}function Nt(t,e,n){for(var r=new Ot(null,null),i=r,o=r;;){var s=n(t,e.key);if(s<0){if(null===e.left)break;if(n(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}o.left=e,o=e,e=e.left}else{if(!(s>0))break;if(null===e.right)break;if(n(t,e.right.key)>0){l=e.right;if(e.right=l.left,l.left=e,null===(e=l).right)break}i.right=e,i=e,e=e.right}}return i.right=e.left,o.left=e.right,e.left=r.right,e.right=r.left,e}function Lt(t,e,n,r){var i=new Ot(t,e);if(null===n)return i.left=i.right=null,i;var o=r(t,(n=Nt(t,n,r)).key);return o<0?(i.left=n.left,i.right=n,n.left=null):o>=0&&(i.right=n.right,i.left=n,n.right=null),i}function jt(t,e,n){var r=null,i=null;if(e){var o=n((e=Nt(t,e,n)).key,t);0===o?(r=e.left,i=e.right):o<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function Ct(t,e,n,r,i){if(t){r(e+(n?"└── ":"├── ")+i(t)+"\n");var o=e+(n?"    ":"│   ");t.left&&Ct(t.left,o,!1,r,i),t.right&&Ct(t.right,o,!0,r,i)}}var zt=function(){function t(t){void 0===t&&(t=Mt),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=Lt(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new Ot(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var r=this._comparator,i=Nt(t,this._root,r),o=r(t,i.key);return 0===o?this._root=i:(o<0?(n.left=i.left,n.right=i,i.left=null):o>0&&(n.right=i.right,n.left=i,i.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=Nt(t,e,n)).key)?(null===e.left?r=e.right:(r=Nt(t,e.left,n)).right=e.right,this._size--,r):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=Nt(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=Nt(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,r=[],i=!1;!i;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):i=!0;return this},t.prototype.range=function(t,e,n,r){for(var i=[],o=this._comparator,s=this._root;0!==i.length||s;)if(s)i.push(s),s=s.left;else{if(o((s=i.pop()).key,e)>0)break;if(o(s.key,t)>=0&&n.call(r,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,r=0,i=[];!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){var e=t,n=[],r=!1,i=new Ot(null,null),o=i;for(;!r;)e?(n.push(e),e=e.left):n.length>0?e=(e=o=o.next=n.pop()).right:r=!0;return o.next=null,i.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var r=t.length,i=this._comparator;if(n&&Dt(t,e,0,r-1,i),null===this._root)this._root=Bt(t,e,0,r),this._size=r;else{var o=function(t,e,n){var r=new Ot(null,null),i=r,o=t,s=e;for(;null!==o&&null!==s;)n(o.key,s.key)<0?(i.next=o,o=o.next):(i.next=s,s=s.next),i=i.next;null!==o?i.next=o:null!==s&&(i.next=s);return r.next}(this.toList(),function(t,e){for(var n=new Ot(null,null),r=n,i=0;i<t.length;i++)r=r.next=new Ot(t[i],e[i]);return r.next=null,n.next}(t,e),i);r=this._size+r,this._root=Tt({head:o},0,r)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return Ct(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var r=this._comparator,i=jt(t,this._root,r),o=i.left,s=i.right;r(t,e)<0?s=Lt(e,n,s,r):o=Lt(e,n,o,r),this._root=function(t,e,n){return null===e?t:(null===t||((e=Nt(t.key,e,n)).left=t),e)}(o,s,r)},t.prototype.split=function(t){return jt(t,this._root,this._comparator)},t}();function Bt(t,e,n,r){var i=r-n;if(i>0){var o=n+Math.floor(i/2),s=t[o],l=e[o],u=new Ot(s,l);return u.left=Bt(t,e,n,o),u.right=Bt(t,e,o+1,r),u}return null}function Tt(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),o=Tt(t,e,i),s=t.head;return s.left=o,t.head=t.head.next,s.right=Tt(t,i+1,n),s}return null}function Dt(t,e,n,r,i){if(!(n>=r)){for(var o=t[n+r>>1],s=n-1,l=r+1;;){do{s++}while(i(t[s],o)<0);do{l--}while(i(t[l],o)>0);if(s>=l)break;var u=t[s];t[s]=t[l],t[l]=u,u=e[s],e[s]=e[l],e[l]=u}Dt(t,e,n,l,i),Dt(t,e,l+1,r,i)}}function Ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qt(t,e,n){return e&&Gt(t.prototype,e),n&&Gt(t,n),t}var $t=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},Vt=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},Ht=Number.EPSILON;void 0===Ht&&(Ht=Math.pow(2,-52));var Ut=Ht*Ht,Yt=function(t,e){if(-Ht<t&&t<Ht&&-Ht<e&&e<Ht)return 0;var n=t-e;return n*n<Ut*t*e?0:t<e?-1:1},Xt=function(){function t(){Ft(this,t),this.reset()}return qt(t,[{key:"reset",value:function(){this.xRounder=new Jt,this.yRounder=new Jt}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),Jt=function(){function t(){Ft(this,t),this.tree=new zt,this.round(0)}return qt(t,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===Yt(e.key,n.key))return this.tree.remove(t),n.key;var r=this.tree.next(e);return null!==r&&0===Yt(e.key,r.key)?(this.tree.remove(t),r.key):t}}]),t}(),Kt=new Xt,Qt=function(t,e){return t.x*e.y-t.y*e.x},Wt=function(t,e){return t.x*e.x+t.y*e.y},Zt=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y},o=Qt(r,i);return Yt(o,0)},te=function(t){return Math.sqrt(Wt(t,t))},ee=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return Wt(i,r)/te(i)/te(r)},ne=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},re=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},ie=function(){function t(e,n){Ft(this,t),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}return qt(t,null,[{key:"compare",value:function(e,n){var r=t.comparePoints(e.point,n.point);return 0!==r?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:se.compare(e.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),qt(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,r=e.length;n<r;n++){var i=e[n];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var r=e+1;r<t;r++){var i=this.point.events[r];void 0===i.consumedBy&&(n.otherSE.point.events===i.otherSE.point.events&&n.segment.consume(i.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,r=function(r){var i,o,s,l,u,f=r.otherSE;n.set(r,{sine:(i=e.point,o=t.point,s=f.point,l={x:o.x-i.x,y:o.y-i.y},u={x:s.x-i.x,y:s.y-i.y},Qt(u,l)/te(u)/te(l)),cosine:ee(e.point,t.point,f.point)})};return function(t,e){n.has(t)||r(t),n.has(e)||r(e);var i=n.get(t),o=i.sine,s=i.cosine,l=n.get(e),u=l.sine,f=l.cosine;return o>=0&&u>=0?s<f?1:s>f?-1:0:o<0&&u<0?s<f?-1:s>f?1:0:u<o?-1:u>o?1:0}}}]),t}(),oe=0,se=function(){function t(e,n,r,i){Ft(this,t),this.id=++oe,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=i}return qt(t,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,r=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(i<r)return-1;var s=t.leftSE.point.y,l=e.leftSE.point.y,u=t.rightSE.point.y,f=e.rightSE.point.y;if(n<r){if(l<s&&l<u)return 1;if(l>s&&l>u)return-1;var h=t.comparePoint(e.leftSE.point);if(h<0)return 1;if(h>0)return-1;var a=e.comparePoint(t.rightSE.point);return 0!==a?a:-1}if(n>r){if(s<l&&s<f)return-1;if(s>l&&s>f)return 1;var c=e.comparePoint(t.leftSE.point);if(0!==c)return c;var p=t.comparePoint(e.rightSE.point);return p<0?1:p>0?-1:1}if(s<l)return-1;if(s>l)return 1;if(i<o){var g=e.comparePoint(t.rightSE.point);if(0!==g)return g}if(i>o){var y=t.comparePoint(e.rightSE.point);if(y<0)return 1;if(y>0)return-1}if(i!==o){var v=u-s,d=i-n,x=f-l,b=o-r;if(v>d&&x<b)return 1;if(v<d&&x>b)return-1}return i>o?1:i<o||u<f?-1:u>f?1:t.id<e.id?-1:t.id>e.id?1:0}}]),qt(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,r=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var i=(t.y-e.y)/r.y,o=e.x+i*r.x;if(t.x===o)return 0;var s=(t.x-e.x)/r.x,l=e.y+s*r.y;return t.y===l?0:t.y<l?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),r=Vt(e,n);if(null===r)return null;var i=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,l=t.rightSE.point,u=$t(e,s)&&0===this.comparePoint(s),f=$t(n,i)&&0===t.comparePoint(i),h=$t(e,l)&&0===this.comparePoint(l),a=$t(n,o)&&0===t.comparePoint(o);if(f&&u)return a&&!h?o:!a&&h?l:null;if(f)return h&&i.x===l.x&&i.y===l.y?null:i;if(u)return a&&o.x===s.x&&o.y===s.y?null:s;if(a&&h)return null;if(a)return o;if(h)return l;var c=function(t,e,n,r){if(0===e.x)return re(n,r,t.x);if(0===r.x)return re(t,e,n.x);if(0===e.y)return ne(n,r,t.y);if(0===r.y)return ne(t,e,n.y);var i=Qt(e,r);if(0==i)return null;var o={x:n.x-t.x,y:n.y-t.y},s=Qt(o,e)/i,l=Qt(o,r)/i;return{x:(t.x+l*e.x+(n.x+s*r.x))/2,y:(t.y+l*e.y+(n.y+s*r.y))/2}}(i,this.vector(),s,t.vector());return null===c?null:$t(r,c)?Kt.round(c.x,c.y):null}},{key:"split",value:function(e){var n=[],r=void 0!==e.events,i=new ie(e,!0),o=new ie(e,!1),s=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(i);var l=new t(i,s,this.rings.slice(),this.windings.slice());return ie.comparePoints(l.leftSE.point,l.rightSE.point)>0&&l.swapEvents(),ie.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(e){for(var n=this,r=e;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var i=t.compare(n,r);if(0!==i){if(i>0){var o=n;n=r,r=o}if(n.prev===r){var s=n;n=r,r=s}for(var l=0,u=r.rings.length;l<u;l++){var f=r.rings[l],h=r.windings[l],a=n.rings.indexOf(f);-1===a?(n.rings.push(f),n.windings.push(h)):n.windings[a]+=h}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,r=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var s=this.rings[i],l=this.windings[i],u=e.indexOf(s);-1===u?(e.push(s),n.push(l)):n[u]+=l}for(var f=[],h=[],a=0,c=e.length;a<c;a++)if(0!==n[a]){var p=e[a],g=p.poly;if(-1===h.indexOf(g))if(p.isExterior)f.push(g);else{-1===h.indexOf(g)&&h.push(g);var y=f.indexOf(p.poly);-1!==y&&f.splice(y,1)}}for(var v=0,d=f.length;v<d;v++){var x=f[v].multiPoly;-1===r.indexOf(x)&&r.push(x)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(ve.type){case"union":var n=0===t.length,r=0===e.length;this._isInResult=n!==r;break;case"intersection":var i,o;t.length<e.length?(i=t.length,o=e.length):(i=e.length,o=t.length),this._isInResult=o===ve.numMultiPolys&&i<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var l=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=l(t)!==l(e);break;default:throw new Error("Unrecognized operation type found ".concat(ve.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,n,r){var i,o,s,l=ie.comparePoints(e,n);if(l<0)i=e,o=n,s=1;else{if(!(l>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));i=n,o=e,s=-1}return new t(new ie(i,!0),new ie(o,!1),[r],[s])}}]),t}(),le=function(){function t(e,n,r){if(Ft(this,t),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=Kt.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var o=i,s=1,l=e.length;s<l;s++){if("number"!=typeof e[s][0]||"number"!=typeof e[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=Kt.round(e[s][0],e[s][1]);u.x===o.x&&u.y===o.y||(this.segments.push(se.fromRing(o,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),o=u)}i.x===o.x&&i.y===o.y||this.segments.push(se.fromRing(o,i,this))}return qt(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),t}(),ue=function(){function t(e,n){if(Ft(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new le(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,i=e.length;r<i;r++){var o=new le(e[r],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=n}return qt(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var r=this.interiorRings[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),t}(),fe=function(){function t(e,n){if(Ft(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(s){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,i=e.length;r<i;r++){var o=new ue(e[r],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=n}return qt(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var r=this.polys[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),t}(),he=function(){function t(e){Ft(this,t),this.events=e;for(var n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}return qt(t,null,[{key:"factory",value:function(e){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];if(o.isInResult()&&!o.ringOut){for(var s=null,l=o.leftSE,u=o.rightSE,f=[l],h=l.point,a=[];s=l,l=u,f.push(l),l.point!==h;)for(;;){var c=l.getAvailableLinkedEvents();if(0===c.length){var p=f[0].point,g=f[f.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(g.x,", ").concat(g.y,"]."))}if(1===c.length){u=c[0].otherSE;break}for(var y=null,v=0,d=a.length;v<d;v++)if(a[v].point===l.point){y=v;break}if(null===y){a.push({index:f.length,point:l.point});var x=l.getLeftmostComparator(s);u=c.sort(x)[0].otherSE;break}var b=a.splice(y)[0],m=f.splice(b.index);m.unshift(m[0].otherSE),n.push(new t(m.reverse()))}n.push(new t(f))}}return n}}]),qt(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,r=this.events.length-1;n<r;n++){var i=this.events[n].point,o=this.events[n+1].point;0!==Zt(i,t,o)&&(e.push(i),t=i)}if(1===e.length)return null;var s=e[0],l=e[1];0===Zt(s,t,l)&&e.shift(),e.push(e[0]);for(var u=this.isExteriorRing()?1:-1,f=this.isExteriorRing()?0:e.length-1,h=this.isExteriorRing()?e.length:-1,a=[],c=f;c!=h;c+=u)a.push([e[c].x,e[c].y]);return a}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var r=this.events[e];ie.compare(t,r)>0&&(t=r)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();i=o.prevInResult(),o=i?i.prevInResult():null}}}]),t}(),ae=function(){function t(e){Ft(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return qt(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),t}(),ce=function(){function t(e){Ft(this,t),this.rings=e,this.polys=this._composePolys(e)}return qt(t,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new ae(i));else{var o=i.enclosingRing();o.poly||e.push(new ae(o)),o.poly.addInterior(i)}}return e}}]),t}(),pe=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:se.compare;Ft(this,t),this.queue=e,this.tree=new zt(n),this.segments=[]}return qt(t,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=r,o=r,s=void 0,l=void 0;void 0===s;)null===(i=this.tree.prev(i))?s=null:void 0===i.key.consumedBy&&(s=i.key);for(;void 0===l;)null===(o=this.tree.next(o))?l=null:void 0===o.key.consumedBy&&(l=o.key);if(t.isLeft){var u=null;if(s){var f=s.getIntersection(e);if(null!==f&&(e.isAnEndpoint(f)||(u=f),!s.isAnEndpoint(f)))for(var h=this._splitSafely(s,f),a=0,c=h.length;a<c;a++)n.push(h[a])}var p=null;if(l){var g=l.getIntersection(e);if(null!==g&&(e.isAnEndpoint(g)||(p=g),!l.isAnEndpoint(g)))for(var y=this._splitSafely(l,g),v=0,d=y.length;v<d;v++)n.push(y[v])}if(null!==u||null!==p){var x=null;if(null===u)x=p;else if(null===p)x=u;else{x=ie.comparePoints(u,p)<=0?u:p}this.queue.remove(e.rightSE),n.push(e.rightSE);for(var b=e.split(x),m=0,E=b.length;m<E;m++)n.push(b[m])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&l){var S=s.getIntersection(l);if(null!==S){if(!s.isAnEndpoint(S))for(var _=this._splitSafely(s,S),w=0,k=_.length;w<k;w++)n.push(_[w]);if(!l.isAnEndpoint(S))for(var P=this._splitSafely(l,S),R=0,A=P.length;R<A;R++)n.push(P[R])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var r=t.split(e);return r.push(n),void 0===t.consumedBy&&this.tree.insert(t),r}}]),t}(),ge="undefined"!=typeof process&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,ye="undefined"!=typeof process&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,ve=new(function(){function t(){Ft(this,t)}return qt(t,[{key:"run",value:function(t,e,n){ve.type=t,Kt.reset();for(var r=[new fe(e,!0)],i=0,o=n.length;i<o;i++)r.push(new fe(n[i],!1));if(ve.numMultiPolys=r.length,"difference"===ve.type)for(var s=r[0],l=1;l<r.length;)null!==Vt(r[l].bbox,s.bbox)?l++:r.splice(l,1);if("intersection"===ve.type)for(var u=0,f=r.length;u<f;u++)for(var h=r[u],a=u+1,c=r.length;a<c;a++)if(null===Vt(h.bbox,r[a].bbox))return[];for(var p=new zt(ie.compare),g=0,y=r.length;g<y;g++)for(var v=r[g].getSweepEvents(),d=0,x=v.length;d<x;d++)if(p.insert(v[d]),p.size>ge)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var b=new pe(p),m=p.size,E=p.pop();E;){var S=E.key;if(p.size===m){var _=S.segment;throw new Error("Unable to pop() ".concat(S.isLeft?"left":"right"," SweepEvent ")+"[".concat(S.point.x,", ").concat(S.point.y,"] from segment #").concat(_.id," ")+"[".concat(_.leftSE.point.x,", ").concat(_.leftSE.point.y,"] -> ")+"[".concat(_.rightSE.point.x,", ").concat(_.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(p.size>ge)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(b.segments.length>ye)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var w=b.process(S),k=0,P=w.length;k<P;k++){var R=w[k];void 0===R.consumedBy&&p.insert(R)}m=p.size,E=p.pop()}Kt.reset();var A=he.factory(b.segments);return new ce(A).getGeom()}}]),t}()),de={union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return ve.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return ve.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return ve.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return ve.run("difference",t,n)}},xe={exports:{}},be=function(t,e){this.p1=t,this.p2=e};be.prototype.rise=function(){return this.p2[1]-this.p1[1]},be.prototype.run=function(){return this.p2[0]-this.p1[0]},be.prototype.slope=function(){return this.rise()/this.run()},be.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},be.prototype.isVertical=function(){return!isFinite(this.slope())},be.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},be.prototype._perpendicularDistanceHorizontal=function(t){return Math.abs(this.p1[1]-t[1])},be.prototype._perpendicularDistanceVertical=function(t){return Math.abs(this.p1[0]-t[0])},be.prototype._perpendicularDistanceHasSlope=function(t){var e=this.slope(),n=this.yIntercept();return Math.abs(e*t[0]-t[1]+n)/Math.sqrt(Math.pow(e,2)+1)},be.prototype.perpendicularDistance=function(t){return this.isVertical()?this._perpendicularDistanceVertical(t):this.isHorizontal()?this._perpendicularDistanceHorizontal(t):this._perpendicularDistanceHasSlope(t)};var me=be,Ee=function(t,e){for(var n=0,r=0,i=1;i<=t.length-2;i++){var o=new me(t[0],t[t.length-1]).perpendicularDistance(t[i]);o>n&&(r=i,n=o)}if(n>e)var s=Ee(t.slice(0,r),e),l=Ee(t.slice(r,t.length),e),u=s.concat(l);else u=t.length>1?[t[0],t[t.length-1]]:[t[0]];return u},Se=Ee;!function(t){var e=Se;function n(e,n){var r=e.geometry,i=r.type;if("LineString"===i)r.coordinates=t.exports.simplify(r.coordinates,n);else if("Polygon"===i||"MultiLineString"===i)for(var o=0;o<r.coordinates.length;o++)r.coordinates[o]=t.exports.simplify(r.coordinates[o],n);else if("MultiPolygon"===i)for(var s=0;s<r.coordinates.length;s++)for(var l=0;l<r.coordinates[s].length;l++)r.coordinates[s][l]=t.exports.simplify(r.coordinates[s][l],n);return e}t.exports=function(t,e,r){return r||(t=JSON.parse(JSON.stringify(t))),t.features?function(t,e){for(var r=0;r<t.features.length;r++)t.features[r]=n(t.features[r],e);return t}(t,e):t.type&&"Feature"===t.type?n(t,e):new Error("FeatureCollection or individual Feature required")},t.exports.simplify=function(t,n){return e(t,n)}}(xe);var _e=xe.exports;export{T as E,B as F,p as a,V as b,v as c,z as d,y as e,d as f,q as g,g as h,de as i,lt as j,It as k,$ as l,F as m,b as o,ft as r,_e as s,G as t,x as u};
